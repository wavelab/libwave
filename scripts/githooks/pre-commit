#!/bin/bash
set -e  # exit on first error
REPO_ABS_PATH=`git rev-parse --show-toplevel`
STAGED_FILES=`git status --porcelain | sed s/^...//`

# run clang-format on staged cpp or hpp files
for file in $STAGED_FILES
do
    if [[ $FILE == *.cpp || $FILE == *.hpp ]]; then
        echo "Clang-Formatting [${FILE}]"
        $REPO_ABS_PATH/scripts/format.bash ${FILE}
        git add ${FILE}
    fi
done
